using System;
using System.IO.Ports;
using System.Text;

namespace Serial_Port_Emulator
{
    internal class Program
    {
        public struct CortexPacket
        {
            public byte[] prefix;
            public string commandtype;
            public int datasize;
            public byte data;
            public byte[] reserved;
            public byte[] crc14;
        }
        public static string readCommand(byte[] commandbytes)
        {
            CortexPacket packet = new CortexPacket();
            byte[] prefix = new byte[4];
            byte[] commandtype = new byte[1];
            byte[] sizeencoded = new byte[4];
            Array.Copy(commandbytes, 0, prefix, 0, 4);
            Array.Copy(commandbytes, 4, commandtype, 0, 1);
            Array.Copy(commandbytes, 5, sizeencoded, 0, 1);
            int datasize = BitConverter.ToInt32(sizeencoded);
            byte[] data = new byte[datasize];
            Array.Copy(commandbytes, 6, data, 0, datasize);

            return Encoding.UTF8.GetString(commandtype) + Encoding.UTF8.GetString(data);
        }
        static void Main(string[] args)
        {
            device();
        }
        static void device()
        {
            SerialPort serialport = new SerialPort("COM5");
            serialport.Open();
            while (true)
            {
                var bytestoread = serialport.BytesToRead;
                byte[] buffer = new byte[bytestoread];
                if (serialport.Read(buffer, 0, bytestoread) != 0)
                {
                    string command = readCommand(buffer);
                    Console.WriteLine(command);
                    Console.WriteLine(Convert.ToHexString(buffer));
                    if (command == "G(21D)")
                    {
                        Console.WriteLine("Get USB Speed");
                        serialport.Write(Convert.FromHexString("01585231013DB70CB7000012E7001101581E61702F6430303030303030310004FFFF"), 0, 34);
                    }
                    if (command == "G(42)")
                    {
                        Console.WriteLine("Expect Acknowledgement From Host");
                        serialport.Write(Convert.FromHexString("01585231013DB70CB7000012E7001101581E61702F6430303030303030300004232E"), 0, 34);
                    }
                    if (command == "G(08)")
                    {
                        Console.WriteLine("Reader Packet Format");
                        serialport.Write(Convert.FromHexString("01585231013DB70CB8000013BF001101581E61702F6430303030303030320004DE0F"), 0, 34);
                    }
                    if (command.Contains("Y") == true)
                    {
                        Console.WriteLine("Acknowlegement Signal");
                    }
                    if (command.Contains("I") == true)
                    {
                        Console.WriteLine("Sending Device Info.");
                        serialport.Write(Convert.FromHexString("01585231013DB70CB600001277004501581E61702F6931333036313330366E6F6E653030323038323137373241303630303030303038303030373030313730303733303030320963642831362E312E3335290004FFFF"), 0, 86);
                    }
                    if (Convert.ToHexString(buffer) == "EEEEEEEE24010500357A")
                    {
                        Console.WriteLine("Decode Barcodes");
                        serialport.Write(Convert.FromHexString("01585231013DF4A39700028567000801581E61702F6404486201585231013DF4A37B00028567000558203D20306924"), 0, 47);
                    }
                    if (Convert.ToHexString(buffer) == "EEEEEEEE5106283166352931001A3E")
                    {
                        Console.WriteLine("Ifrared Camera Enable");
                        serialport.Write(Convert.FromHexString("01585231013DF4A3960002849E000801581E61702F6404AD14"), 0, 25);
                    }
                    if (Convert.ToHexString(buffer) == "EEEEEEEE240107005318")
                    {
                        Console.WriteLine("Get Picture Name");
                        serialport.Write(Convert.FromHexString("01585231013DF4A3A300028883000801581E61702F6404230501585231013DF4A3A400028885001901581E61702F6D706963747572653030303030322E6A7067043B24"), 0, 67);
                    }
                    if (Convert.ToHexString(buffer) == "EEEEEEEE5E11706963747572653030303030322E6A706700562B")
                    {
                        Console.WriteLine("Send the Picture");
                        serialport.Write(Convert.FromHexString("01585231013DF4A3A5000289DE002101581E61702F67706963747572653030303030322E6A70670928383839352900042B4701585231013DF4A305000289DE0FFFFFD8FFE000104A46494600010100000100010000FFFE03D43C70726F70657274793E3C496D616765416763547970653E303C2F496D616765416763547970653E3C636170747572653E32443C2F636170747572653E3C696C6C756D206368616E6E656C3D2730273E36343C2F696C6C756D3E3C696C6C756D206368616E6E656C3D2731273E36343C2F696C6C756D3E3C696C6C756D206368616E6E656C3D2732273E36343C2F696C6C756D3E3C696C6C756D206368616E6E656C3D2733273E46463C2F696C6C756D3E3C6578706F737572653E3C6578706F7375726554696D655F7831303E42453C2F6578706F7375726554696D655F7831303E3C6578706F7375726556616C75653E3330303C2F6578706F7375726556616C75653E3C65787056616C75655265673E3330303C2F65787056616C75655265673E3C6578704C696E6554696D655265673E3637323C2F6578704C696E6554696D655265673E3C2F6578706F737572653E3C6761696E3E3C636F6C756D6E3E323C2F636F6C756D6E3E3C676C6F62616C3E32303C2F676C6F62616C3E3C64633E343C2F64633E3C2F6761696E3E3C6669656C64732076616C75653D272D31273E3C6669656C642076616C75653D2730273E3C6465636F64655374617475733E303C2F6465636F64655374617475733E3C6465636F646574696D653E303C2F6465636F646574696D653E3C6465636F646574696D656C696D69743E303C2F6465636F646574696D656C696D69743E3C6D69643E363C2F6D69643E3C6272696768746E6573735F7831303E3146343C2F6272696768746E6573735F7831303E3C6E6578746272696768746E6573735F7831303E3345383C2F6E6578746272696768746E6573735F7831303E3C656467653E353C2F656467653E3C7175616C6974795F70657263656E743E303C2F7175616C6974795F70657263656E743E3C2F6669656C643E3C6669656C642076616C75653D2731273E3C6465636F64655374617475733E303C2F6465636F64655374617475733E3C6465636F646574696D653E303C2F6465636F646574696D653E3C6465636F646574696D656C696D69743E303C2F6465636F646574696D656C696D69743E3C6D69643E46464646464646463C2F6D69643E3C6272696768746E6573735F7831303E46464646464646463C2F6272696768746E6573735F7831303E3C6E6578746272696768746E6573735F7831303E46464646464646463C2F6E6578746272696768746E6573735F7831303E3C656467653E303C2F656467653E3C7175616C6974795F70657263656E743E46464646464646463C2F7175616C6974795F70657263656E743E3C2F6669656C643E3C2F6669656C64733E3C2F70726F70657274793EFFDB004300100B0C0E0C0A100E0D0E1211101318281A181616183123251D283A333D3C3933383740485C4E404457453738506D51575F626768673E4D71797064785C656763FFC0000B0803C0028001011100FFC4001F0000010501010101010100000000000000000102030405060708090A0BFFC400B5100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FAFFDA0008010100003F00E228A28A28A2928A28A28A28A28A5A28A28A28A28A28A28A2969296928A28A28A5A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A2928A28A28A28A4A28A28A28A28A5A28A28A28A28A28A28A28A28A28A28A2968A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A2928A28A28A28A4A28A28A28A28A5A28A28A28A28A28A296928A28A28A28A29692968A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A292968A2928A28A28A28A4A28A28A28A28A5A4A5A28A28A28A28A28A28A28A296928A28A28A5A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A2928A28A28A28A4A28A28A28A28A28A5A28A28A28A28A28A28A28A28A28A28A28A5A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A2928A28A28A28A28A4A28A28A28A28A2968A28A28A28A28A28A28A28A28A28A5A28A28A28A28A4A5A2928A5A28A28A28A28A28A28A28A28A28A292968A28A2928A28A28A28A28A2928A28A28A28A2968A28A28A28A28A28A28A28A28A28A28A5A4A5A4A28A28A5A4A29692968A28A292968A4A28A5A28A28A28A28A28A28A2928A28A292968A28A28A4A28A28A28A29692968A28A28A28A28A28A28A28A28A28A28A28A28A28A28A2968A28A4A5A29296928A28A28A2968A28A2928A28A5A2928A29296928A2968A2928A28A28A28A28A28A2968A28A28A28A28A28A28A28A28A28A28A28A28A28A5A292968A28A4A5A4A28A28A28A2968A28A29296928A2969B4B45145251451452D1494514514514514514B494B45145252D14514514514514514514514514514514B45145145145252D251451451451452D252D251451452D25252D145251452D2514B45149451451451451451452D145252D14514514514514514514514514514B45145145145145149451451451451452D20A5A2928A28A28A4A5A28A2928A28A28A28A28A28A28A28A28A28A5A28A28A28A28A28A28A28A28A296928A28A5A28A28A28A28A2928A28A28A28A28A28A28A5A4A28A28A28A4A5A4A5A4A28A28A28A296928A28A28A28A28A28A5A28A28A28A28A28A28A28A28A28A28A28A5A28A28A28A28A28A4A28A28A28A28A28A28A28A28A28A28A4A5A4A5A2928A28A28A28A28A28A28A28A28A2968A292968A28A28A28A28A28A28A28A0514514B45145145145145145149451451451451451451451451451494514514514514514514514514514514514514514B49452D1451451494B4514514514514514B4514514514514514514514945145145145145145145145251451451451451451451451451451451451451452D149451452D145252D252D14514514514514B451494B45145145145145149451451451451451451451452514514514514514514514514514514514514514514514514B494B4514514514514514514514B494B451494B45145145252D14945145145145145145145149451451451451451451451451451451451451451451451451452D1451451451451451451451452D252D145145145145145145251451451451451451451494514514514514514514514514514514514514514514514514514B451451451451451451451452D1494B451451451451451451452514514514514514525252D1451451451451451451451451451451451451451451451451452D14514514514514514514514B494B451451451451451451451451452514514514525252D1451451451451451451451451451451451451451451451451452D1451451451451451451451452D145252D14514514514514945145145145145149451451451451451451451451451451451451451451451451451451452D2514B4514514514514514514514514B451451451451451451494514514514945149452D1451451451451451451451451451451451451451451451451451451452D1451451451451451451452D1451451451451451452514514514525149452D14514514514514514514514514514514514514514514514514514514514514B451451451451451451452D252D1451451451451451494514525145149452D1451451451451494B4514514514514514514514514514514514514514514514B4514514514514514514B452514B494B4514514514525145149451451494514B451451451451494B451451451451451451451451451451451451451451451452D14514514514514514B494514514514B45145251466928A28A28A28A28A4A2968A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A5A28A28A28A28A28A28A28A28A28A296928A2928A28A5A2928A5A4A2928A2968A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A5A2928A5A4A2968A28A28A28A28A28A28A28A4A28A2968A28A4A28A2928A2968A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A296928A28A28A5A28A28A28A28A28A28A4A28A5A292968A28A4A29692928A5A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A2968A28A28A2928A28A2968A4A5A292968A4A5A2928A28A4A2968A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A2968A28A2928A28A28A5A28A4A5A292968A4A28A28A28A4A29D49451451451451451451451451451494B4514514514514514514514514514514514514514514514B494514514514514B45149452D252D1494514B4525149453A8A4A28A28A28A28A4A5A28A4A28A28A28A2968A28A28A28A292968A28A28A28A28A28A28A28A28A28A28A28A28A28A2968A2928A28A296928A28A28A28A4A5A28A28A28A2928A28A2969296928A28A28A2968A28A28A28A2929692968A28A28A28A28A28A28A28A28A28A28A28A28A2968A4A28A28A5A4A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A4A28A5A292968A28A292968A28A28A28A28A28A28A2815347182324D23617A54468A28A5A4A28A28A28A28A28A28A28A28A28A28A28A28A296928A28A28A28A28A28A28A28A28A2928A5A28A28A4A5A2928A5A28A28A28A28A28A2928A514E0E40A6E734514514B45251451451451451451451451451451451452D14525145145145145145145145145145251452D149452D1451494B45252D1451451451494514B451451451451451451451451451451451451451451451452D145149451451451451451451451451451494514B494B45145149452D252D145145145149451452D1451451451451451494B451451451451451451451451452D251451451451451494514514B45145145145251452D145149451452D145145252D145145149452D1494B494B451451451451451451451451451451451451451451451451451451494B494514B451451451452514514B451494B49452D145251452D1494B451452514B49452D1451451451451494B451451451451451451451494B45145145145145145252D251452D1451451452514514B451494B494514B451494B45145145145251451452D1451451451451494514B45145145145145145145145145145145145145251451452D1451451451494514B45145251452D1451494B45149452D145149452D1451451451451451494514B451451451451451451451451451451451451451494514514B45145145149451452D149451451452D1451494B49451452D1494514B494B451451451451452514B494514B494B451451451451451451451451451451494B494514B451451451452514514B45145252D1451451451494B45251451451452D251452D145252D145251451451452D145145145145145583101585231013DF4A306000289DE0FFF1451451451451451451451451451451451451494514514B45145145145145145252D251452D2514514514514B452514B45251451451452D145145145145145145145145145145145145145145145145145149451451452D145145145145145149451451451451451451452D251452D2514514514514B4514514514514514514514514514B4514514514945145145145145251452D145145145145145145251451451451451451451452D1494514514514514514B4514514514514514514514514514B4514514514945145145145145149452D1451451451451451451494B49452D2514514514514514514514514514514514B45145145145145145145145145140A5A28A28A28A4A28A28A28A28A2928A2968A28A28A28A28A28A28A4A5A4A28A28A28A28A28A5A4A28A28A28A28A28A2968A28A28A28A28A28A28A28A28A28A5A28A28A28A28A28A4A28A28A28A4A28A5A28A28A28A28A28A28A4A28A28A28A28A28A28A28A28A28A28A28A28A28A5A28A28A28A28A28A28A28A28A2814B45145145145145145149451451494514B451451451451451452514514B45252D251451451451452D2514514514514514B4514514514514514514514514514B4514514514514514525145145149451452D1451451451451451494B49452D251451451451451451451451451451451452D14514514514514514514514514B45145145145145251451451452514514B45145145145145145145145145252D1494514514B494514514514514514514514B4514514514514514514514B45145145145145251451451451451494514B451451451451451451451451451451452514514514514514514514514514514B452514B451451451451452D145145145145145145251451451451451451451451451451451451451451451451451494B49452D2514514514514514514514514502968A28A28A28A2968A292968A28A28A28A28A28A292968A2928A28A28A28A28A28A28A28A28A28A28A28A28A28A2928A296928A28A28A28A28A28A28A28A28A5A28A28A28A2968A28A28A28A28A28A28A28A4A2968A28A2928A28A28A28A28A28A28A28A28A5A28A4A28A28A2928A5A2928A28A28A28A28A28A28A28A28A5A28A28A28A5A28A28A28A28A28A28A28A2928A28A28A5A28A4A28A28A28A28A28A28A5A4A5A28A2928A28A28A4A2968A29296928A28A28A28A28A28A28A28A5A28A2968A28A28A28A28A28A28A28A28A2928A28A28A2968A4A28A28A28A28A28A2968A28A28A28A4A28A28A28A2928A28A28A28A28A28A28A28A28A28A5A28A2968A28A28A28A28A28A28A28A28A4A28A28A28A28A28A28A28A28A28A28A2968A28A28A28A4A28A28A28A28A4A28A28A28A28A28A28A28A28A28A5A28A28A5A28A28A28A28A28A28A28A2928A28A28A28A296928A28A28A28A28A28A2968A28A28A28A28A4A28A28A2928A28A5A4A28A28A28A28A28A28A28A5A28A28A2968A296928A296928A28A28A28A4A5A4A28A28A28A5A4A28A28A28A28A28A5A28A28A28A28A2928A5A4A28A28A4A28A5A2928A28A28A28A28A28A28A5A28A28A5A28A5A28A28A29296928A28A28A28A4A5A2928A28A5A4A28A28A28A28A28A5A28A28A28A28A4A28A28A28A28A4A28A28A28A28A28A28A28A28A28A5A28A2968A2968A28A28A28A4A296928A28A28A28A4A28A5A28A4A28A28A28A28A2968A28A28A28A28A4A296928A28A28A4A296928A28A5A4A28A28A28A28A28A5A28A2968A2968A28A28A28A28A4A28A28A28A28A2928A2968A4A28A28A28A28A2968A28A28A28A28A4A5A4A28A28A28A4A28A2968A28A28A28A2928A296928A5A28A2968A2968A28A28A28A29296928A28A28A28A2928A2968A4A28A28A28A28A2968A28A28A28A28A4A296928A28A28A4A2968A28A28A28A28A28A28A2928A5A2968A28A28A5A28A28A28A28A2928A28A28A28A28A4A5A4A5A28A28A4A28A28A28A5A28A28A28A28A28A28A4A28A28A28A28A28A28A28A28A28A28A28A4A5A28A5A28A28A2968A28A28A4A5A28A28A4A28A28A28A28A28A2928A28A28A28A28A5A28A28A28A292968A28A2928A28A28A28A296928A28A28A28A28A28A28A28A5A28A28A2968A28A28A28A28A28A2928A28A28A28A28A4A28A28A28A28A28A2968A28A28A28A28A28A28A4A28A28A28A5A2928A296928A28A28A28A28A28A5A4A28A5A2968A28A28A28A28A28A2928A28A28A28A28A4A28A28A28A28A28A28A5A28A28A28A28A28A28A2928A28A5A28A2928A28A28A28A28A28A28A28A28A28A5A28A5A28A28A28A296928A28A28C518A28C5251451494514514514514514514B45145145145145145145252D145145145145145149451452D2514514514B494514B4514B4514514B45145251451451452D1494525149451451451451451451452D145145145145145145145145145145145149452D2514514514514514B49452D1451452D14514B45145149452D2514514514514945251452D14628A4A28A2968A28A28A28A28A28A28A28A28A28A28A28A28A2928A28A28A28A28A28A28A5A28A28A2968A28A5A28A28A28A2928A28A28A4A28A28A28A28A28A28A4A5A28A28A28A28A28A28A28A28A28A28A28A28A28A292968A28A4A5A4A28A2968A28A28A28A28A5A28A28A5A28A4A28A28A28A28A4A28A28A28A28A28A28A28A28A28A28A292968A28A28A28A28A28A28A28A28A28A28A28A4A5A4A28A2968A28A28A28A28A5A28A28A5A4A28A28A28A28A2928A28A28A28A28A28A28A28A28A28A28A2928A28A5A28A28A28A28A28A28A28A2928A5A2928A2968A28A28A28A28A28A28A5A28A28A296928A28A28A4A5A4A28A28A28A28A28A28A28A28A28A296928A2928A28A2968A28A28A28A28A28A28A292968A2928A2968A28A28A28A296928A2968A28A28A28A28A28A4A28A28A28A28A28A28A28A28A28A28A28A296928A28A4A28A28A5A28A28A28A28A28A28A4A5A4A5A2928A2968A28A28A5A2928A2968A28A28A28A28A28A4A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A4A28A28A5A28A28A28A28A28A4A5A28A28A4A2968A28A28A5A28145145145145145145145145251451451451451451451451451451451451451451451452514514514B4514514514514514514514514514514514514B494B4514514514514514514514945145145145145145145145145145145145145145145149451451451452D14628A28A28A28A28A28A28A28A28A28A28A28A28A5A28A28A28A28A28A28A4A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A4A28A28A28A5A4A2968A28A28A28A28A28A28A28A28A292968A28A2968A28A28A28A2928A28A5A4A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A4A28A28A28A5A4A28A5A28A28A28A28A28A28A28A28A292968A28A5A4A5A28A28A2928A5A4A2968A4A28A28A4A2968A28A28A28A28A28A28A28A28A28A28A28A4A28A28A28A5A28A28A051451451451451452D2514514514514514B45145145145252D1494B4525145145251452D1451451452D149451451451451451451451494514514514B451451452D2514514514B494B49451451451451451452D149451452D145145145149451494B49452D1452D145145145251451451451451451494514514514514B45145145028A28A28A5A28A29296928A28A28A28A28A28A28A28A5A4A28A28A28A28A292968A28A2968A28A28A2928A28A28A28A28A28A2928A28A28A28A2968A28A28A28A2968A28A28A28A4A28A28A28A28A28A28A28A28A28A28A28A28A28A292968A28A28A2968A28A28A4A28A28A28A28A28A4A28A28A28A28A28A5A28A28A28A5A4A2968A28A28A2928A28A28A28A28A28A28A28A28A28A292968A28A28A28A28A296928A5A28A28A2928A28A28A28A2928A28A28A296928A2968A28A28A28A052D145145145251451451494B4514514514514514514514514514514514514514514B45252D14514525145145145145251451451452D14514514514514B45252D2514514B49451451452514B451451451494B4514514514514514514514514514514B49452D145145251451451494514514514514B45145145252D14514B45251451451451451494514514B451451451494B451451451451451451451451452D252D251451452D14945145145145251451451452D145145145252D14514514B494B49451451451494514514B45145251452D252D14514514514514B49451451452D1494B494B49452D149451451452514514514514B451451451451451451451451451451451451494514514B45145252D2514B4514514514514514B494514B45252D1451451494514B45149451451451451452514B45145145145145145145145145028A28A28A2928A28A29692968A4A28A28A51451451451451452D251452D145145145149452D252D145149451451451451451451451451451451451451451451451451451494514514514B451452514514B4514514514514B45251452D145252D1494B45252D14514525145145145145145145145145145145145145145145145145252D1494514514514514514514514B451451451452D145251452D1494B494B45145145145149451451451451451451451451451451451451451451451451451451494514514514514514514514B40A28A28A28A5A28A4A5A4A5A28A28A28A28A28A4A5A28A28A4A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A28A4A28A28A28A28A28A28A29692968A28A28A28A5A28A28A4A5A28A28A28A28A28A28A28A28A2928A28A28A28A2968A2928A5A4A28A28A28A28A28A28A292968A2928A28A28A28A28A296928A2968A28A28A28A5A28A28A28A28A28A28A28A28A28A28A28A2928A28A28A28A2968A4A28A28A28A28A28A28A28A28A28A28A2928A28A28A28A28A28A28A2968A28A28A28A2968A28A28A28A28A28A28A28A28A28A28A28A4A28A28A28A052D14514514945145145145145145145145145251451451451451451451451452D1451451452D1451451451451451451451451451451451452514514514B4514514514514945145145145145145145145149451451451451451451451452D1451451452D1451451451451451451451451451451451452514514514B45145145252D149451451451451451451451451452514514514514514514514B451451451451452D1451451451451451451451451451451451452514B494B451451452514514B45252D25145145145145149451451451451451451451451452D1451451451452D1494B45145145145145145145252D1451452514B451451494B451452514514B494B4945145145145145149451451451451451451451451452D14514514514514B45145145145145145145252D1451451451451451494B494B45145252D252D149451451451452D14945149451451451451451451451451451452D14514514514B45145145145145145251452D1451451494B45145251451452D1451451494B45251451451452D14525145251451451451451451451451451452D14514514514B451451451451451452514514B49451451452D145251452D251452D1451452514514514514514B49451452514514514514514B494B45251451452D1451451452D14514514514B49451452514B45251451451452D145145252D2514514514B45149451452D25145145145145251EC5001585231013DF4A307000289DE02C14514514514B45145145145149452D1451452D1451451451452D14525145149451451451452D145145145149451451451451451451451451451451451451494514514514B45145145145145252D14514B494B49452D14514B451451494525145140A28A5A28A28A28A28A28A28A28A4A28A28A28A28A28A28A28A28A28A4A28A28A28A5A28A28A28A28A28A292968A28A28A2968A296814B451494514945251451452D145145145145145145145149452D25145145145145145145145149451451451452D145145145145145252D14514514B4514B451451451451451494628A28A28A28A28A28A28A28A28ED451451452514514514B4945145145145149451451451452D1451451451451451451451452D1452D1451451451451451451494514514514514514514B452514514514525145145145145145145145145149451451452D14514514514514514514514B452D145252D1451451451451451451494514514514514B45145145252D2514514945145145145145252D1451451452514514514B451451451451451451452D14B452514B45145145145145145145145251452D2514514B45145149452D251451494514B49451451451494B45145145251451451452D14514514514514514514B4514514B451451451451451451452D25149452D1451451451451451451452514514514945145145252D1451451494B49451451452D1494B494B451451494B4528A28A28A5A28A28A28A28A28A28A28A5A2928A28A28A28A28A28A28A28A28A2928A28A2928A28A28A28A28A28A28A2928A28A28A5A2928A2968A28A28A2814B451452D1494B4514514514514514B45145149451451451451451451451451451494514945145145145145145145252D2514514514514514514514B4514514B451452D14514514514514514514B45145145251451451452D251451451451451452514945145145252D145145145252D1495FFFD9DCB301585231013DF4A3A6000289DE001401581E61702F64454F46092833313334302900040B98"), 0, 9033);
                    }
                }
            }
            serialport.Close();
        }
    }
}